## DataMutation


- 이전에는, 서버사이드에서 보낸 HTTP 요청을 통해 외부출처에서 데이터를 가져오거나, 서버에서 직접 데이터를 가져오도록 했다


- 데이터를 변경하고, 새로운 데이터를 저장하는 방법 
  - 데이터를 가져올 뿐만아니라, 어떤시점에서 데이터를 변경하거나 추가해야 하기 때문이다.
  - NextJS 에서 데이터를 조작하고 업데이트하는 방법


- form 데이터 처리방법은
  1. 분리된 독립형 백엔드 API 를 설치하여, 양식 데이터를 포함한 요청을 받아들이는것
  2. 로직을 통합하여, NextJS app 이 양식을 직접 저장하고, 처리

---

- server action 은 Next 의 기능이 아니라, React 의 기능이다 
  - React 는 Next 가 아니더라도, server 에서 사용가능하다


- form action 과 server action 은 차이점이 존재한다


- React 는 client or server 에서 양식 제출을 처리하는 방법을 제공하는데, 그 방법이 훨씬 간단해졌다
  - formAction 은 단순히 정의하는 함수이다


- formAction 을 사용할때는, 값을 추출하는 input 에 모두 name 을 설정해야한다
  - 또한, formAction 에서 등록하는 함수는 server action 이다
  - 따라서, 해당 함수는 server 에서 동작한다( "use server" 지시어 반드시 추가 )


- "use server" 지시어는 서버에서만 실행된다는것을 의미하거나 보장하지않는다
  - ( 클라이언트로부터 코드를 숨기기위해 사용할 수 없다 )


- 만약 클라이언트에서 절대 실행되어서는 안되는 코드가 있다면 "server-only" 패키지를 사용해야한다


- formAction 은 form 의 action 뿐만아니라, button 의 action 으로도 사용할 수 있다


- 좋아요 같은 기능을 할때는, next 가 페이지데이터를 캐싱하기 때문에, 데이터의 변경사항을 저장하지 않는다
  - 따라서, revalidatePath 같은 메서드를 업데이트가 필요할 경우에, 호출해주어야 한다


- 낙관적 업데이트는 결국 서버요청이 성공할것이라 믿고, 업데이트를 수행하는것이다( 그후, 뒷단에서 업데이트를 실행한다 )


- next 는 빌드할때, 모든 페이지를 prerender 하기 때문에, 변경사항이 있어도 반영하지 않는다


- 따라서, revalidatePath 같은 함수로, 변경사항을 적용할 페이지에 직접 변경사항을 업데이트하도록 지시해야한다